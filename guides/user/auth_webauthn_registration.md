---
exclude: true
toc:
  maxDepth: 2
---
# WebAuthn for logged-out users

To address the limitations of password-based authentication Mosaic's hosted login solution allows you to integrate WebAuthn, a passwordless approach that reinforces security while enhancing user experience. WebAuthn leverages [FIDO](https://fidoalliance.org/how-fido-works/)'s public key cryptography, enabling users to authenticate with biometric passkeys instead of passwords, reducing the risk of tampering. 

Hosted WebAuthn gives you the flexibility to implement different flows based on your use case and the user experience you'd like to provide your customers.

This guide addresses how to deploy into your app WebAuthn authentication using Mosaic's hosted login solution. To learn how to delegate your entire authentication experience to Mosaic, refer to our [hosted login deployment](/guides/user/hosted_login_quick_start.md) guide.

## Key concepts

Unlike email or SMS-based authentication methods, WebAuthn registration doesn't inherently verify that the user is who they claim to be (e.g., by sending an OTP to confirm the user's email). To identify the user, WebAuthn relies on a representation of the user in your system, provided by a user context, which includes the following:

- **WebAuthn credentials**: these are identifiers generated by the system and associated with the specific user, the Mosaic app, and the relying party domain (pre-configured in the Admin Portal, under your WebAuthn Authentication settings). Credentials are registered on the current device.

- **Username**: this is set during credential registration and can be provided for each authentication request. The username must correspond to the WebAuthn credentials registered on the current device. A username can be a user's email, phone number, or another verifiable user identifier known to the user (such as an account ID). If the username is used by a different authentication method (e.g., passwords), it should match the WebAuthn one.

## Use case

This guide refers to the scenario where you're managing your users externally, such as using an external identity provider or your own solution, and your app only delegates WebAuthn authentication to Mosaic. In this context, after a user logs in to your app and is required to authenticate with WebAuthn, your app prompts Mosaic to perform authentication. As a result, Mosaic will either register or log in a user in your application, not directly within Mosaic itself.

## logged-out user identification

When you prompt WebAuthn registration and/or authentication for logged-out users, Mosaic doesn't have access to user information saved into your app, which means that Mosaic no username can be used to identify a user. To enable user identification without sharing user data, Mosaic hosted solution replaces user information with WEbAuthn credentials. These credentials will be saved to the device used to scan biometrics, associated to the biometric code itself and identified by an `external_user_id`.

## logged-out user registration flow

Here's an overview of the registration flow for logged-out users.

1. Make sure the user has already been verified using an external [verification process](/guides/webauthn/key_concepts.md#verification).
2. Register WebAuthn credentials on the device for the verified username.
3. Register WebAuthn credentials in Mosaic for the logged-out user (logged-out of Mosaic, not the website) using a [client access token](/openapi/client_access_tokens/) and an external identifier of the user in your system. This will create a new user in the Mosaic system if no existing user with the external user ID is found; otherwise the credentials are registered to the existing user.

:::info Note
- To register credentials for new users to your Mosaic application, [public sign-up](/guides/user/manage_apps.md#advanced-settings) must be enabled.
- If the user already exists for your Mosaic application (e.g., by authenticating using a different Mosaic login method) but an external user ID wasn't set for this user, this flow will create a new user when they register credentials for the first time.
:::